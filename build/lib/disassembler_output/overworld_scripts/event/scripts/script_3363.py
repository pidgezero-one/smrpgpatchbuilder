# E3363_KEEP_BALL_SOLITAIRE_KICK_BALL

from smrpgpatchbuilder.datatypes.overworld_scripts.event_scripts.classes import EventScript
from smrpgpatchbuilder.datatypes.overworld_scripts.event_scripts.commands import *
from smrpgpatchbuilder.datatypes.overworld_scripts.action_scripts import *
from smrpgpatchbuilder.datatypes.overworld_scripts.action_scripts.commands import *
from smrpgpatchbuilder.datatypes.overworld_scripts.arguments.area_objects import *
from smrpgpatchbuilder.datatypes.overworld_scripts.arguments.colours import *
from smrpgpatchbuilder.datatypes.overworld_scripts.arguments.controller_inputs import *
from smrpgpatchbuilder.datatypes.overworld_scripts.arguments.coords import *
from smrpgpatchbuilder.datatypes.overworld_scripts.arguments.directions import *
from smrpgpatchbuilder.datatypes.overworld_scripts.arguments.intro_title_text import *
from smrpgpatchbuilder.datatypes.overworld_scripts.arguments.layers import *
from smrpgpatchbuilder.datatypes.overworld_scripts.arguments.palette_types import *
from smrpgpatchbuilder.datatypes.overworld_scripts.arguments.scenes import *
from smrpgpatchbuilder.datatypes.overworld_scripts.arguments.tutorials import *
from smrpgpatchbuilder.datatypes.overworld_scripts.action_scripts.arguments import *
from ....variables.action_script_names import *
from ....variables.battlefield_names import *
from ....variables.dialog_names import *
from ....variables.event_script_names import *
from ....variables.music_names import *
from ....variables.overworld_area_names import *
from ....variables.overworld_sfx_names import *
from ....variables.pack_names import *
from ....variables.room_names import *
from ....variables.shop_names import *
from ....variables.variable_names import *
from ....items import *
from ....packets import *

script = EventScript([
	ActionQueueAsync(target=MARIO, subscript=[
		A_Set700CToObjectCoord(target_npc=MARIO, coord=COORD_F),
		A_CopyVarToVar(from_var=PRIMARY_TEMP_700C, to_var=ROSE_WAY_7038)
	]),
	CopyVarToVar(from_var=ACTIVE_NPC, to_var=PRIMARY_TEMP_7000),
	AddConstToVar(PRIMARY_TEMP_7000, 65515),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=SECONDARY_TEMP_7024),
	JmpIf7000AnyBitsSet(bits=[1], destinations=["EVENT_3363_jmp_if_7000_any_bits_set_12"]),
	JmpIf7000AnyBitsSet(bits=[3], destinations=["EVENT_3363_jmp_if_var_equals_const_9"]),
	JmpIfVarEqualsConst(ROSE_WAY_7038, 7, ["EVENT_3363_copy_var_to_var_19"]),
	JmpIfVarEqualsConst(ROSE_WAY_7038, 1, ["EVENT_3363_copy_var_to_var_35"]),
	Jmp(["EVENT_3363_play_sound_153"]),
	JmpIfVarEqualsConst(ROSE_WAY_7038, 1, ["EVENT_3363_copy_var_to_var_35"], identifier="EVENT_3363_jmp_if_var_equals_const_9"),
	JmpIfVarEqualsConst(ROSE_WAY_7038, 3, ["EVENT_3363_copy_var_to_var_53"]),
	Jmp(["EVENT_3363_play_sound_153"]),
	JmpIf7000AnyBitsSet(bits=[3], destinations=["EVENT_3363_jmp_if_var_equals_const_16"], identifier="EVENT_3363_jmp_if_7000_any_bits_set_12"),
	JmpIfVarEqualsConst(ROSE_WAY_7038, 5, ["EVENT_3363_copy_var_to_var_71"]),
	JmpIfVarEqualsConst(ROSE_WAY_7038, 7, ["EVENT_3363_copy_var_to_var_19"]),
	Jmp(["EVENT_3363_play_sound_153"]),
	JmpIfVarEqualsConst(ROSE_WAY_7038, 5, ["EVENT_3363_copy_var_to_var_71"], identifier="EVENT_3363_jmp_if_var_equals_const_16"),
	JmpIfVarEqualsConst(ROSE_WAY_7038, 3, ["EVENT_3363_copy_var_to_var_53"]),
	Jmp(["EVENT_3363_play_sound_153"]),
	CopyVarToVar(from_var=SECONDARY_TEMP_7024, to_var=PRIMARY_TEMP_7000, identifier="EVENT_3363_copy_var_to_var_19"),
	AddConstToVar(PRIMARY_TEMP_7000, 25),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=TEMP_70A9),
	JmpIfObjectInCurrentLevel(MEM_70A9, ["EVENT_3363_play_sound_153"]),
	AddConstToVar(PRIMARY_TEMP_7000, 4),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=TEMP_70A9),
	JmpIfObjectInCurrentLevel(MEM_70A9, ["EVENT_3363_copy_var_to_var_27"]),
	Jmp(["EVENT_3363_play_sound_153"]),
	CopyVarToVar(from_var=SECONDARY_TEMP_7024, to_var=PRIMARY_TEMP_7000, identifier="EVENT_3363_copy_var_to_var_27"),
	AddConstToVar(PRIMARY_TEMP_7000, 21),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=ACTIVE_NPC),
	AddConstToVar(PRIMARY_TEMP_7000, 4),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=TEMP_70A9),
	AddConstToVar(PRIMARY_TEMP_7000, 4),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=TEMP_70AA),
	Jmp(["EVENT_3363_clear_bit_89"]),
	CopyVarToVar(from_var=SECONDARY_TEMP_7024, to_var=PRIMARY_TEMP_7000, identifier="EVENT_3363_copy_var_to_var_35"),
	AddConstToVar(PRIMARY_TEMP_7000, 22),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=TEMP_70A9),
	JmpIfObjectInCurrentLevel(MEM_70A9, ["EVENT_3363_play_sound_153"]),
	AddConstToVar(PRIMARY_TEMP_7000, 1),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=TEMP_70A9),
	JmpIfObjectInCurrentLevel(MEM_70A9, ["EVENT_3363_copy_var_to_var_43"]),
	Jmp(["EVENT_3363_play_sound_153"]),
	CopyVarToVar(from_var=SECONDARY_TEMP_7024, to_var=PRIMARY_TEMP_7000, identifier="EVENT_3363_copy_var_to_var_43"),
	AddConstToVar(PRIMARY_TEMP_7000, 21),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=ACTIVE_NPC),
	AddConstToVar(PRIMARY_TEMP_7000, 1),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=TEMP_70A9),
	AddConstToVar(PRIMARY_TEMP_7000, 1),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=TEMP_70AA),
	ClearBit(TEMP_7043_1),
	ClearBit(TEMP_7043_2),
	Jmp(["EVENT_3363_clear_bit_89"]),
	CopyVarToVar(from_var=SECONDARY_TEMP_7024, to_var=PRIMARY_TEMP_7000, identifier="EVENT_3363_copy_var_to_var_53"),
	AddConstToVar(PRIMARY_TEMP_7000, 17),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=TEMP_70A9),
	JmpIfObjectInCurrentLevel(MEM_70A9, ["EVENT_3363_play_sound_153"]),
	AddConstToVar(PRIMARY_TEMP_7000, 65532),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=TEMP_70A9),
	JmpIfObjectInCurrentLevel(MEM_70A9, ["EVENT_3363_copy_var_to_var_61"]),
	Jmp(["EVENT_3363_play_sound_153"]),
	CopyVarToVar(from_var=SECONDARY_TEMP_7024, to_var=PRIMARY_TEMP_7000, identifier="EVENT_3363_copy_var_to_var_61"),
	AddConstToVar(PRIMARY_TEMP_7000, 21),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=ACTIVE_NPC),
	AddConstToVar(PRIMARY_TEMP_7000, 65532),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=TEMP_70A9),
	AddConstToVar(PRIMARY_TEMP_7000, 65532),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=TEMP_70AA),
	ClearBit(TEMP_7043_1),
	ClearBit(TEMP_7043_2),
	Jmp(["EVENT_3363_clear_bit_89"]),
	CopyVarToVar(from_var=SECONDARY_TEMP_7024, to_var=PRIMARY_TEMP_7000, identifier="EVENT_3363_copy_var_to_var_71"),
	AddConstToVar(PRIMARY_TEMP_7000, 20),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=TEMP_70A9),
	JmpIfObjectInCurrentLevel(MEM_70A9, ["EVENT_3363_play_sound_153"]),
	AddConstToVar(PRIMARY_TEMP_7000, 65535),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=TEMP_70A9),
	JmpIfObjectInCurrentLevel(MEM_70A9, ["EVENT_3363_copy_var_to_var_79"]),
	Jmp(["EVENT_3363_play_sound_153"]),
	CopyVarToVar(from_var=SECONDARY_TEMP_7024, to_var=PRIMARY_TEMP_7000, identifier="EVENT_3363_copy_var_to_var_79"),
	AddConstToVar(PRIMARY_TEMP_7000, 21),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=ACTIVE_NPC),
	AddConstToVar(PRIMARY_TEMP_7000, 65535),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=TEMP_70A9),
	AddConstToVar(PRIMARY_TEMP_7000, 65535),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=TEMP_70AA),
	ClearBit(TEMP_7043_1),
	ClearBit(TEMP_7043_2),
	Jmp(["EVENT_3363_clear_bit_89"]),
	ClearBit(TEMP_7043_1, identifier="EVENT_3363_clear_bit_89"),
	ClearBit(TEMP_7043_2),
	ActionQueueSync(target=MARIO, subscript=[
		A_Set700CToObjectCoord(target_npc=DUMMY_0X07, coord=COORD_F),
		A_JmpIfVarEqualsConst(PRIMARY_TEMP_700C, 7, ["EVENT_3363_action_queue_91_SUBSCRIPT_set_sprite_sequence_5"]),
		A_JmpIfVarEqualsConst(PRIMARY_TEMP_700C, 1, ["EVENT_3363_action_queue_91_SUBSCRIPT_set_sprite_sequence_7"]),
		A_JmpIfVarEqualsConst(PRIMARY_TEMP_700C, 3, ["EVENT_3363_action_queue_91_SUBSCRIPT_set_sprite_sequence_9"]),
		A_JmpIfVarEqualsConst(PRIMARY_TEMP_700C, 5, ["EVENT_3363_action_queue_91_SUBSCRIPT_set_sprite_sequence_11"]),
		A_SetSpriteSequence(index=9, sprite_offset=1, is_sequence=True, looping=True, mirror_sprite=True, identifier="EVENT_3363_action_queue_91_SUBSCRIPT_set_sprite_sequence_5"),
		A_Jmp(["EVENT_3363_action_queue_91_SUBSCRIPT_pause_13"]),
		A_SetSpriteSequence(index=8, sprite_offset=1, is_sequence=True, looping=True, mirror_sprite=True, identifier="EVENT_3363_action_queue_91_SUBSCRIPT_set_sprite_sequence_7"),
		A_Jmp(["EVENT_3363_action_queue_91_SUBSCRIPT_pause_13"]),
		A_SetSpriteSequence(index=8, sprite_offset=1, is_sequence=True, looping=True, identifier="EVENT_3363_action_queue_91_SUBSCRIPT_set_sprite_sequence_9"),
		A_Jmp(["EVENT_3363_action_queue_91_SUBSCRIPT_pause_13"]),
		A_SetSpriteSequence(index=9, sprite_offset=1, is_sequence=True, looping=True, identifier="EVENT_3363_action_queue_91_SUBSCRIPT_set_sprite_sequence_11"),
		A_Jmp(["EVENT_3363_action_queue_91_SUBSCRIPT_pause_13"]),
		A_Pause(12, identifier="EVENT_3363_action_queue_91_SUBSCRIPT_pause_13"),
		A_ResetProperties()
	]),
	ActionQueueSync(target=MEM_70A8, subscript=[
		A_CopyVarToVar(from_var=ROSE_WAY_7038, to_var=PRIMARY_TEMP_700C),
		A_FaceEast7C(),
		A_UnknownCommand(bytearray(b'\xc8\x07')),
		A_PlaySound(sound=SO066_KICK_BALL_SHELL, channel=4),
		A_JumpToHeight(height=124, silent=True),
		A_SetSolidityBits(cant_pass_npcs=True, bit_7=True),
		A_WalkFDirectionSteps(2),
		A_SetBit(TEMP_7043_1),
		A_JumpToHeight(height=120, silent=True),
		A_WalkFDirectionSteps(2),
		A_SetBit(TEMP_7043_2),
		A_VisibilityOff(),
		A_UnknownCommand(bytearray(b'\x99')),
		A_VisibilityOff(),
		A_ObjectMemorySetBit(arg_1=0x30, bits=[4]),
		A_ClearSolidityBits(bit_4=True, cant_pass_npcs=True, cant_walk_through=True, bit_7=True),
		A_ReturnAll()
	]),
	ActionQueueSync(target=MEM_70A9, subscript=[
		A_Pause(1, identifier="EVENT_3363_action_queue_93_SUBSCRIPT_pause_0"),
		A_JmpIfBitClear(TEMP_7043_1, ["EVENT_3363_action_queue_93_SUBSCRIPT_pause_0"]),
		A_PlaySound(sound=SO022_CLOSE_DOOR, channel=4),
		A_VisibilityOff(),
		A_ObjectMemorySetBit(arg_1=0x30, bits=[4]),
		A_ClearSolidityBits(bit_4=True, cant_pass_npcs=True, cant_walk_through=True, bit_7=True),
		A_Pause(8),
		A_UnknownCommand(bytearray(b'\xfd\x9cW')),
		A_ReturnAll()
	]),
	ActionQueueAsync(target=MEM_70AA, subscript=[
		A_Pause(1, identifier="EVENT_3363_action_queue_94_SUBSCRIPT_pause_0"),
		A_JmpIfBitClear(TEMP_7043_2, ["EVENT_3363_action_queue_94_SUBSCRIPT_pause_0"]),
		A_VisibilityOn(),
		A_ObjectMemoryClearBit(arg_1=0x30, bits=[4]),
		A_SetSolidityBits(bit_4=True, cant_pass_npcs=True, cant_walk_through=True, bit_7=True),
		A_ReturnAll()
	]),
	Dec(ROSE_WAY_703E),
	JmpIfVarEqualsConst(ROSE_WAY_703E, 1, ["EVENT_3363_pause_155"]),
	Jmp(["EVENT_3363_clear_bit_98"]),
	ClearBit(TEMP_7043_0, identifier="EVENT_3363_clear_bit_98"),
	SetVarToConst(SECONDARY_TEMP_7024, 0),
	CopyVarToVar(from_var=SECONDARY_TEMP_7024, to_var=PRIMARY_TEMP_7000, identifier="EVENT_3363_copy_var_to_var_100"),
	AddConstToVar(PRIMARY_TEMP_7000, 21),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=TEMP_70A9),
	JmpIfObjectInCurrentLevel(MEM_70A9, ["EVENT_3363_inc_149"]),
	CopyVarToVar(from_var=SECONDARY_TEMP_7024, to_var=PRIMARY_TEMP_7000),
	JmpIf7000AnyBitsSet(bits=[1], destinations=["EVENT_3363_jmp_if_7000_any_bits_set_113"]),
	JmpIf7000AnyBitsSet(bits=[3], destinations=["EVENT_3363_jmp_to_subroutine_110"]),
	JmpToSubroutine(["EVENT_3363_copy_var_to_var_120"]),
	JmpToSubroutine(["EVENT_3363_copy_var_to_var_126"]),
	Jmp(["EVENT_3363_inc_149"]),
	JmpToSubroutine(["EVENT_3363_copy_var_to_var_126"], identifier="EVENT_3363_jmp_to_subroutine_110"),
	JmpToSubroutine(["EVENT_3363_copy_var_to_var_132"]),
	Jmp(["EVENT_3363_inc_149"]),
	JmpIf7000AnyBitsSet(bits=[3], destinations=["EVENT_3363_jmp_to_subroutine_117"], identifier="EVENT_3363_jmp_if_7000_any_bits_set_113"),
	JmpToSubroutine(["EVENT_3363_copy_var_to_var_138"]),
	JmpToSubroutine(["EVENT_3363_copy_var_to_var_120"]),
	Jmp(["EVENT_3363_inc_149"]),
	JmpToSubroutine(["EVENT_3363_copy_var_to_var_138"], identifier="EVENT_3363_jmp_to_subroutine_117"),
	JmpToSubroutine(["EVENT_3363_copy_var_to_var_132"]),
	Jmp(["EVENT_3363_inc_149"]),
	CopyVarToVar(from_var=SECONDARY_TEMP_7024, to_var=PRIMARY_TEMP_7000, identifier="EVENT_3363_copy_var_to_var_120"),
	AddConstToVar(PRIMARY_TEMP_7000, 25),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=TEMP_70A9),
	AddConstToVar(PRIMARY_TEMP_7000, 4),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=TEMP_70AA),
	Jmp(["EVENT_3363_jmp_if_present_in_current_level_144"]),
	CopyVarToVar(from_var=SECONDARY_TEMP_7024, to_var=PRIMARY_TEMP_7000, identifier="EVENT_3363_copy_var_to_var_126"),
	AddConstToVar(PRIMARY_TEMP_7000, 22),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=TEMP_70A9),
	AddConstToVar(PRIMARY_TEMP_7000, 1),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=TEMP_70AA),
	Jmp(["EVENT_3363_jmp_if_present_in_current_level_144"]),
	CopyVarToVar(from_var=SECONDARY_TEMP_7024, to_var=PRIMARY_TEMP_7000, identifier="EVENT_3363_copy_var_to_var_132"),
	AddConstToVar(PRIMARY_TEMP_7000, 17),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=TEMP_70A9),
	AddConstToVar(PRIMARY_TEMP_7000, 65532),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=TEMP_70AA),
	Jmp(["EVENT_3363_jmp_if_present_in_current_level_144"]),
	CopyVarToVar(from_var=SECONDARY_TEMP_7024, to_var=PRIMARY_TEMP_7000, identifier="EVENT_3363_copy_var_to_var_138"),
	AddConstToVar(PRIMARY_TEMP_7000, 20),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=TEMP_70A9),
	AddConstToVar(PRIMARY_TEMP_7000, 65535),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=TEMP_70AA),
	Jmp(["EVENT_3363_jmp_if_present_in_current_level_144"]),
	JmpIfObjectInCurrentLevel(MEM_70A9, ["EVENT_3363_ret_146"], identifier="EVENT_3363_jmp_if_present_in_current_level_144"),
	JmpIfObjectInCurrentLevel(MEM_70AA, ["EVENT_3363_set_bit_147"]),
	Return(identifier="EVENT_3363_ret_146"),
	SetBit(TEMP_7043_0, identifier="EVENT_3363_set_bit_147"),
	Return(),
	Inc(SECONDARY_TEMP_7024, identifier="EVENT_3363_inc_149"),
	JmpIfVarNotEqualsConst(SECONDARY_TEMP_7024, 16, ["EVENT_3363_copy_var_to_var_100"]),
	JmpIfBitClear(TEMP_7043_0, ["EVENT_3363_play_sound_168"]),
	Return(),
	PlaySound(sound=SO088_WRONG_SIGNAL, channel=4, identifier="EVENT_3363_play_sound_153"),
	Return(),
	Pause(8, identifier="EVENT_3363_pause_155"),
	ClearBit(TEMP_7044_7),
	SetSyncActionScript(NPC_0, A0059_SEWER_STAIR_UPPER_RIGHT_RAT_PACING_AND_BOWSERS_KEEP_GAME_MOLDS),
	PlaySound(sound=SO087_CORRECT_SIGNAL, channel=4),
	Pause(16),
	PlayMusicAtDefaultVolume(M0009_VICTORY),
	RunDialog(dialog_id=DI1914_EMPTY, above_object=NPC_12, closable=True, sync=False, multiline=True, use_background=False),
	SetBit(TEMP_7044_7),
	ActionQueueAsync(target=NPC_0, subscript=[
		A_StartLoopNTimes(3),
		A_VisibilityOff(),
		A_Pause(2),
		A_VisibilityOn(),
		A_Pause(2),
		A_EndLoop(),
		A_VisibilityOff(),
		A_ClearSolidityBits(bit_4=True, cant_walk_through=True)
	]),
	PlaySound(sound=SO016_OPEN_DOOR, channel=6),
	ApplyTileModToLevel(use_alternate=True, room_id=R468_BOWSERS_KEEP_6DOOR_PUZZLE_ROOM_2C_BALL_SOLITAIRE, mod_id=0),
	ApplySolidityModToLevel(permanent=True, room_id=R468_BOWSERS_KEEP_6DOOR_PUZZLE_ROOM_2C_BALL_SOLITAIRE, mod_id=0),
	Return(),
	PlaySound(sound=SO088_WRONG_SIGNAL, channel=4, identifier="EVENT_3363_play_sound_168"),
	Pause(16),
	PlayMusicAtDefaultVolume(M0066_BOWSER_SCASTLE_2NDTIME),
	SlowDownMusic(),
	ActionQueueAsync(target=MARIO, subscript=[
		A_SetSpriteSequence(index=12, sprite_offset=2, is_sequence=True, looping=True),
		A_Pause(2)
	]),
	ClearBit(TEMP_7044_7),
	SetSyncActionScript(NPC_0, A0059_SEWER_STAIR_UPPER_RIGHT_RAT_PACING_AND_BOWSERS_KEEP_GAME_MOLDS),
	RunDialog(dialog_id=DI1915_MINIGAME_LOSE, above_object=NPC_14, closable=True, sync=True, multiline=True, use_background=False),
	SetBit(TEMP_7044_7),
	Pause(180),
	FadeOutToBlack(sync=False),
	JmpToEvent(E3356_KEEP_RESPAWN_IN_LOBBY_UPON_FAILURE)
])
