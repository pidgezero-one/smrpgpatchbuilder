# E0465_MUSHROOM_DERBY_BUSINESS_LOGIC

from smrpgpatchbuilder.datatypes.overworld_scripts.event_scripts.classes import EventScript
from smrpgpatchbuilder.datatypes.overworld_scripts.event_scripts.commands import *
from smrpgpatchbuilder.datatypes.overworld_scripts.action_scripts import *
from smrpgpatchbuilder.datatypes.overworld_scripts.action_scripts.commands import *
from smrpgpatchbuilder.datatypes.overworld_scripts.arguments.area_objects import *
from smrpgpatchbuilder.datatypes.overworld_scripts.arguments.colours import *
from smrpgpatchbuilder.datatypes.overworld_scripts.arguments.controller_inputs import *
from smrpgpatchbuilder.datatypes.overworld_scripts.arguments.coords import *
from smrpgpatchbuilder.datatypes.overworld_scripts.arguments.directions import *
from smrpgpatchbuilder.datatypes.overworld_scripts.arguments.intro_title_text import *
from smrpgpatchbuilder.datatypes.overworld_scripts.arguments.layers import *
from smrpgpatchbuilder.datatypes.overworld_scripts.arguments.palette_types import *
from smrpgpatchbuilder.datatypes.overworld_scripts.arguments.scenes import *
from smrpgpatchbuilder.datatypes.overworld_scripts.arguments.tutorials import *
from smrpgpatchbuilder.datatypes.overworld_scripts.action_scripts.arguments import *
from ....variables.action_script_names import *
from ....variables.battlefield_names import *
from ....variables.dialog_names import *
from ....variables.event_script_names import *
from ....variables.music_names import *
from ....variables.overworld_area_names import *
from ....variables.overworld_sfx_names import *
from ....variables.pack_names import *
from ....variables.room_names import *
from ....variables.shop_names import *
from ....variables.variable_names import *
from ....items import *
from ....packets import *

script = EventScript([
	SetBit(UNKNOWN_MUSHROOM_DERBY_7085_4),
	ClearBit(TEMP_7043_4),
	ClearBit(UNKNOWN_MUSHROOM_DERBY_704A_0),
	ClearBit(UNKNOWN_MUSHROOM_DERBY_704A_1),
	ClearBit(TEMP_7043_0),
	ClearBit(TEMP_7043_1),
	ClearBit(TEMP_7043_2),
	ClearBit(TEMP_7043_5),
	ClearBit(TEMP_7043_6),
	ClearBit(TEMP_7043_7),
	ClearBit(TEMP_7044_6),
	ClearBit(TEMP_7044_7),
	SetVarToConst(TEMP_70AE, 0),
	SetVarToConst(TEMP_70AF, 0),
	SetVarToConst(UNKNOWN_70EB, 0),
	SetVarToConst(UNKNOWN_70EE, 0),
	SetVarToConst(SECONDARY_TEMP_7024, 0),
	SetVarToConst(TEMP_7026, 20),
	SetVarToConst(TEMP_702A, 20),
	SetVarToConst(TEMP_702E, 20),
	SetVarToConst(TEMP_7032, 0),
	SetVarToConst(Z_COORD_1, 0),
	SetVarToConst(Y_COORD_1, 0),
	SetVarToConst(X_COORD_1, 0),
	SetVarToConst(X_COORD_2, 0),
	SetVarToConst(Y_COORD_2, 0),
	SetVarToConst(Z_COORD_2, 0),
	SetVarToConst(OLD_STAR_PIECE_ID, 0),
	SetVarToConst(PRIMARY_TEMP_700C, 0),
	SetVarToConst(ROSE_WAY_7038, 0),
	SetVarToConst(ROSE_WAY_703A, 0),
	SetVarToConst(ROSE_WAY_703C, 0),
	SetVarToConst(ROSE_WAY_703E, 0),
	JmpIfBitClear(YOSTER_ISLE_LIBERATED_2, ["EVENT_465_set_var_to_const_50"]),
	SetVarToConst(TEMP_7026, 20),
	SetVarToConst(TEMP_702E, 20),
	SetVarToConst(TEMP_702A, 20),
	SetVarToConst(Z_COORD_1, 20),
	JmpIfBitSet(MUSHROOM_DERBY_AUTO, ["EVENT_465_jmp_if_random_above_66_47"]),
	CopyVarToVar(from_var=UNKNOWN_70B0, to_var=PRIMARY_TEMP_7000),
	JmpIfVarEqualsConst(PRIMARY_TEMP_7000, 3, ["EVENT_465_set_var_to_const_53"]),
	JmpIfVarEqualsConst(PRIMARY_TEMP_7000, 4, ["EVENT_465_set_var_to_const_60"]),
	JmpIfVarEqualsConst(PRIMARY_TEMP_7000, 5, ["EVENT_465_set_var_to_const_70"]),
	JmpIfVarEqualsConst(PRIMARY_TEMP_7000, 6, ["EVENT_465_set_var_to_const_77"]),
	JmpIfVarEqualsConst(PRIMARY_TEMP_7000, 8, ["EVENT_465_set_var_to_const_87"]),
	JmpIfVarEqualsConst(PRIMARY_TEMP_7000, 10, ["EVENT_465_set_var_to_const_97"]),
	JmpIfVarEqualsConst(PRIMARY_TEMP_7000, 20, ["EVENT_465_set_var_to_const_107"]),
	JmpIfRandom2of3(['EVENT_465_set_var_to_const_60', 'EVENT_465_set_var_to_const_77'], identifier="EVENT_465_jmp_if_random_above_66_47"),
	JmpIfRandom1of2(["EVENT_465_set_var_to_const_87"]),
	Jmp(["EVENT_465_set_var_to_const_97"]),
	SetVarToConst(X_COORD_2, 81, identifier="EVENT_465_set_var_to_const_50"),
	SetVarToConst(TEMP_7028, 50),
	Jmp(["EVENT_465_jmp_if_bit_clear_114"]),
	SetVarToConst(X_COORD_2, 79, identifier="EVENT_465_set_var_to_const_53"),
	SetVarToConst(TEMP_7028, 48),
	SetVarToConst(Z_COORD_2, 81),
	SetVarToConst(TEMP_7030, 50),
	SetVarToConst(Y_COORD_2, 76),
	SetVarToConst(TEMP_702C, 68),
	Jmp(["EVENT_465_jmp_if_bit_clear_114"]),
	SetVarToConst(X_COORD_2, 77, identifier="EVENT_465_set_var_to_const_60"),
	SetVarToConst(TEMP_7028, 47),
	SetVarToConst(Z_COORD_2, 79),
	SetVarToConst(TEMP_7030, 45),
	SetVarToConst(Y_COORD_2, 72),
	SetVarToConst(TEMP_702C, 68),
	JmpIfBitClear(MUSHROOM_DERBY_AUTO, ["EVENT_465_jmp_if_bit_clear_114"]),
	SetVarToConst(ROSE_WAY_7038, 74),
	SetVarToConst(ROSE_WAY_703A, 43),
	Jmp(["EVENT_465_fade_out_music_to_volume_123"]),
	SetVarToConst(X_COORD_2, 74, identifier="EVENT_465_set_var_to_const_70"),
	SetVarToConst(TEMP_7028, 45),
	SetVarToConst(Z_COORD_2, 77),
	SetVarToConst(TEMP_7030, 41),
	SetVarToConst(Y_COORD_2, 70),
	SetVarToConst(TEMP_702C, 64),
	Jmp(["EVENT_465_jmp_if_bit_clear_114"]),
	SetVarToConst(X_COORD_2, 70, identifier="EVENT_465_set_var_to_const_77"),
	SetVarToConst(TEMP_7028, 42),
	SetVarToConst(Z_COORD_2, 76),
	SetVarToConst(TEMP_7030, 38),
	SetVarToConst(Y_COORD_2, 68),
	SetVarToConst(TEMP_702C, 62),
	JmpIfBitClear(MUSHROOM_DERBY_AUTO, ["EVENT_465_jmp_if_bit_clear_114"]),
	SetVarToConst(ROSE_WAY_7038, 68),
	SetVarToConst(ROSE_WAY_703A, 38),
	Jmp(["EVENT_465_fade_out_music_to_volume_123"]),
	SetVarToConst(X_COORD_2, 68, identifier="EVENT_465_set_var_to_const_87"),
	SetVarToConst(TEMP_7028, 39),
	SetVarToConst(Z_COORD_2, 74),
	SetVarToConst(TEMP_7030, 34),
	SetVarToConst(Y_COORD_2, 64),
	SetVarToConst(TEMP_702C, 58),
	JmpIfBitClear(MUSHROOM_DERBY_AUTO, ["EVENT_465_jmp_if_bit_clear_114"]),
	SetVarToConst(ROSE_WAY_7038, 65),
	SetVarToConst(ROSE_WAY_703A, 36),
	Jmp(["EVENT_465_fade_out_music_to_volume_123"]),
	SetVarToConst(X_COORD_2, 66, identifier="EVENT_465_set_var_to_const_97"),
	SetVarToConst(TEMP_7028, 35),
	SetVarToConst(Z_COORD_2, 70),
	SetVarToConst(TEMP_7030, 31),
	SetVarToConst(Y_COORD_2, 62),
	SetVarToConst(TEMP_702C, 55),
	JmpIfBitClear(MUSHROOM_DERBY_AUTO, ["EVENT_465_jmp_if_bit_clear_114"]),
	SetVarToConst(ROSE_WAY_7038, 66),
	SetVarToConst(ROSE_WAY_703A, 30),
	Jmp(["EVENT_465_fade_out_music_to_volume_123"]),
	SetVarToConst(X_COORD_2, 56, identifier="EVENT_465_set_var_to_const_107"),
	SetVarToConst(TEMP_7028, 30),
	SetVarToConst(Z_COORD_2, 60),
	SetVarToConst(TEMP_7030, 16),
	SetVarToConst(Y_COORD_2, 52),
	SetVarToConst(TEMP_702C, 44),
	Jmp(["EVENT_465_jmp_if_bit_clear_114"]),
	JmpIfBitClear(YOSTER_ISLE_LIBERATED_2, ["EVENT_465_set_var_to_const_122"], identifier="EVENT_465_jmp_if_bit_clear_114"),
	StoreItemAmountTo7000(YoshiCookieItem),
	CompareVarToConst(PRIMARY_TEMP_7000, 6),
	JmpIfComparisonResultIsGreaterOrEqual(["EVENT_465_set_var_to_const_120"]),
	CopyVarToVar(from_var=PRIMARY_TEMP_7000, to_var=UNKNOWN_70EB),
	Jmp(["EVENT_465_fade_out_music_to_volume_123"]),
	SetVarToConst(UNKNOWN_70EB, 5, identifier="EVENT_465_set_var_to_const_120"),
	Jmp(["EVENT_465_fade_out_music_to_volume_123"]),
	SetVarToConst(UNKNOWN_70EB, 3, identifier="EVENT_465_set_var_to_const_122"),
	FadeOutMusicToVolume(duration=2, volume=0, identifier="EVENT_465_fade_out_music_to_volume_123"),
	Pause(60),
	RememberLastObject(),
	PlayMusicAtDefaultVolume(M0016_LET_SRACE),
	StartSyncEmbeddedActionScript(target=NPC_9, prefix=0xF1, subscript=[
		A_SetSequenceSpeed(SLOW),
		A_SequenceLoopingOn()
	]),
	ActionQueueSync(target=NPC_2, subscript=[
		A_SequenceLoopingOn()
	]),
	ActionQueueSync(target=NPC_3, subscript=[
		A_SequenceLoopingOn()
	]),
	ActionQueueSync(target=NPC_10, subscript=[
		A_SequenceLoopingOn()
	]),
	RememberLastObject(),
	Pause(1, identifier="EVENT_465_pause_132"),
	JmpIfAudioMemoryEquals(4, ["EVENT_465_pause_132"]),
	SlowDownMusicTempoBy(duration=0, change=2),
	Pause(1, identifier="EVENT_465_pause_135"),
	JmpIfAudioMemoryEquals(3, ["EVENT_465_pause_135"]),
	RunBackgroundEvent(event_id=E0466_MUSHROOM_DERBY_BUSINESS_LOGIC_EXTENSION, return_on_level_exit=True),
	JmpIfBitSet(MUSHROOM_DERBY_AUTO, ["EVENT_256_ret_0"]),
	RunBackgroundEvent(event_id=E0468_MUSHROOM_DERBY_USE_YOSHI_COOKIE, return_on_level_exit=True, bit_6=True),
	Set7000ToTappedButton(identifier="EVENT_465_set_7000_to_tapped_button_140"),
	Pause(1),
	JmpIf7000AnyBitsSet(bits=[5], destinations=["EVENT_465_set_bit_172"]),
	JmpIf7000AnyBitsSet(bits=[7], destinations=["EVENT_465_set_bit_177"]),
	JmpIfAudioMemoryEquals(2, ["EVENT_465_set_7000_to_tapped_button_140"]),
	Jmp(["EVENT_465_pause_149"]),
	Pause(1, identifier="EVENT_465_pause_146"),
	JmpIfBitClear(UNKNOWN_MUSHROOM_DERBY_7085_4, ["EVENT_256_ret_0"]),
	JmpIfAudioMemoryEquals(2, ["EVENT_465_pause_146"]),
	Pause(1, identifier="EVENT_465_pause_149"),
	JmpIfBitClear(UNKNOWN_MUSHROOM_DERBY_7085_4, ["EVENT_256_ret_0"]),
	JmpIfAudioMemoryEquals(1, ["EVENT_465_pause_149"]),
	Set7000ToTappedButton(identifier="EVENT_465_set_7000_to_tapped_button_152"),
	JmpIf7000AnyBitsSet(bits=[5], destinations=["EVENT_465_jmp_if_bit_set_162"]),
	JmpIf7000AnyBitsSet(bits=[7], destinations=["EVENT_465_jmp_if_bit_set_167"]),
	Pause(1),
	JmpIfAudioMemoryEquals(2, ["EVENT_465_set_7000_to_tapped_button_152"]),
	ClearBit(UNKNOWN_MUSHROOM_DERBY_704A_0),
	ClearBit(UNKNOWN_MUSHROOM_DERBY_704A_1),
	SetVarToConst(TEMP_7032, 0),
	SetVarToConst(Z_COORD_1, 0),
	Jmp(["EVENT_465_pause_149"]),
	JmpIfBitSet(UNKNOWN_MUSHROOM_DERBY_704A_0, ["EVENT_465_set_bit_182"], identifier="EVENT_465_jmp_if_bit_set_162"),
	JmpIfBitSet(UNKNOWN_MUSHROOM_DERBY_704A_1, ["EVENT_465_set_bit_185"]),
	SetBit(UNKNOWN_MUSHROOM_DERBY_704A_0),
	ClearBit(UNKNOWN_MUSHROOM_DERBY_704A_1),
	Jmp(["EVENT_465_pause_146"]),
	JmpIfBitSet(UNKNOWN_MUSHROOM_DERBY_704A_1, ["EVENT_465_set_bit_182"], identifier="EVENT_465_jmp_if_bit_set_167"),
	JmpIfBitSet(UNKNOWN_MUSHROOM_DERBY_704A_0, ["EVENT_465_set_bit_192"]),
	SetBit(UNKNOWN_MUSHROOM_DERBY_704A_1),
	ClearBit(UNKNOWN_MUSHROOM_DERBY_704A_0),
	Jmp(["EVENT_465_pause_146"]),
	SetBit(UNKNOWN_MUSHROOM_DERBY_704A_0, identifier="EVENT_465_set_bit_172"),
	ClearBit(UNKNOWN_MUSHROOM_DERBY_704A_1),
	SetSyncActionScript(MARIO, A0499_MUSHROOM_DERBY_UNKNOWN),
	SetSyncActionScript(NPC_9, A0431_YOSHI_RACE_ANIMATION),
	Jmp(["EVENT_465_pause_146"]),
	SetBit(UNKNOWN_MUSHROOM_DERBY_704A_1, identifier="EVENT_465_set_bit_177"),
	ClearBit(UNKNOWN_MUSHROOM_DERBY_704A_0),
	SetSyncActionScript(MARIO, A0499_MUSHROOM_DERBY_UNKNOWN),
	SetSyncActionScript(NPC_9, A0431_YOSHI_RACE_ANIMATION),
	Jmp(["EVENT_465_pause_146"]),
	SetBit(TEMP_7043_1, identifier="EVENT_465_set_bit_182"),
	SetVarToConst(TEMP_7032, 0),
	Jmp(["EVENT_465_pause_146"]),
	SetBit(UNKNOWN_MUSHROOM_DERBY_704A_0, identifier="EVENT_465_set_bit_185"),
	ClearBit(UNKNOWN_MUSHROOM_DERBY_704A_1),
	Inc(TEMP_7032),
	CompareVarToConst(TEMP_7032, 4),
	JmpIfComparisonResultIsGreaterOrEqual(["EVENT_465_set_bit_199"]),
	SetBit(TEMP_7043_0),
	Jmp(["EVENT_465_pause_146"]),
	SetBit(UNKNOWN_MUSHROOM_DERBY_704A_1, identifier="EVENT_465_set_bit_192"),
	ClearBit(UNKNOWN_MUSHROOM_DERBY_704A_0),
	Inc(TEMP_7032),
	CompareVarToConst(TEMP_7032, 4),
	JmpIfComparisonResultIsGreaterOrEqual(["EVENT_465_set_bit_199"]),
	SetBit(TEMP_7043_0),
	Jmp(["EVENT_465_pause_146"]),
	SetBit(TEMP_7043_3, identifier="EVENT_465_set_bit_199"),
	SetVarToConst(TEMP_7032, 0),
	Jmp(["EVENT_465_pause_146"])
])
